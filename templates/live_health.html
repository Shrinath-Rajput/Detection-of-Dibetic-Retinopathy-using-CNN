<!DOCTYPE html>
<html>
<head>
    <title>Clinsense-AI | Live Health</title>
    <style>
        body { font-family: Arial; background:#f4f6f8; margin:0 }
        .nav { background:#0d6efd; padding:15px; color:white }
        .container { max-width:900px; margin:30px auto; }
        .card {
            background:white;
            padding:20px;
            border-radius:10px;
            margin-bottom:20px;
            box-shadow:0 4px 12px rgba(0,0,0,0.1)
        }
        h2 { margin-top:0 }
        .value { font-size:22px; font-weight:bold }
    </style>
</head>

<body>

<div class="nav">
    <b>üß† Clinsense-AI</b> | <a href="/" style="color:white">Home</a>
</div>

<div class="container">

<div class="card">
    <h2>‚ù§Ô∏è Live Health Monitoring</h2>
    <p>Heart Rate: <span class="value" id="hr">--</span> BPM</p>
    <p>SpO‚ÇÇ: <span class="value" id="spo2">--</span> %</p>
    <p>Status: <b id="status">--</b></p>
</div>

<div class="card">
    <h2>üß† Health Analysis</h2>
    <p>Heart Rate Status: <b id="hr_status">--</b></p>
    <p>SpO‚ÇÇ Status: <b id="spo2_status">--</b></p>
</div>

<div class="card">
    <h2>‚ö†Ô∏è Risk Prediction</h2>
    <ul id="risk">
        <li>Waiting for data...</li>
    </ul>
</div>

<div class="card">
    <h2>‚úÖ Preventive Advice</h2>
    <ul id="advice">
        <li>Waiting for data...</li>
    </ul>
</div>

</div>

<script>
function fetchData(){

    /* 1Ô∏è‚É£ SENSOR DATA */
    fetch("/live_sensor")
    .then(res => res.json())
    .then(data => {
        document.getElementById("hr").innerText = data.heart_rate ?? "--";
        document.getElementById("spo2").innerText = data.spo2 ?? "--";
        document.getElementById("status").innerText = data.status ?? "--";
    })
    .catch(err => console.error("Sensor error:", err));

    /* 2Ô∏è‚É£ HEALTH ANALYSIS */
    fetch("/health_analysis")
    .then(res => res.json())
    .then(data => {

        document.getElementById("hr_status").innerText =
            data.heart_rate_status || "UNKNOWN";

        document.getElementById("spo2_status").innerText =
            data.spo2_status || "UNKNOWN";

        // Risk
        let riskEl = document.getElementById("risk");
        riskEl.innerHTML = "";
        if (data.risk && data.risk.length > 0) {
            data.risk.forEach(r => {
                let li = document.createElement("li");
                li.innerText = r;
                riskEl.appendChild(li);
            });
        } else {
            riskEl.innerHTML = "<li>No major risk detected</li>";
        }

        // Advice
        let adviceEl = document.getElementById("advice");
        adviceEl.innerHTML = "";
        if (data.advice && data.advice.length > 0) {
            data.advice.forEach(a => {
                let li = document.createElement("li");
                li.innerText = a;
                adviceEl.appendChild(li);
            });
        } else {
            adviceEl.innerHTML = "<li>Maintain healthy lifestyle</li>";
        }
    })
    .catch(err => console.error("Analysis error:", err));
}

setInterval(fetchData, 2000);
fetchData();
</script>

</body>
</html>
